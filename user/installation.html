

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Installation &mdash; edrixs  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
        <script type="text/javascript" src="../_static/copybutton.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="edrixs and docker" href="usedocker.html" />
    <link rel="prev" title="What is edrixs?" href="whatisedrixs.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> edrixs
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">edrixs User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="whatisedrixs.html">What is edrixs?</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#install-and-use-edrixs-via-anaconda-only-linux-now">Install and use edrixs via Anaconda (only Linux now)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-from-source">Build from source</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ubuntu-linux-18-04">Ubuntu Linux 18.04</a></li>
<li class="toctree-l4"><a class="reference internal" href="#macos-mojave-osx-10-14">macOS Mojave (OSX 10.14)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="usedocker.html">edrixs and docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html">Quickstart tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="basics.html">edrixs basics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">edrixs Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release-history.html">Release History</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">edrixs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">edrixs User Guide</a> &raquo;</li>
        
      <li>Installation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/user/installation.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<p>Several tools and libraries are required to build and install edrixs,</p>
<blockquote>
<div><ul class="simple">
<li><p>Fortran compiler: gfortran and ifort are supported</p></li>
<li><p>MPI environment: openmpi and mpich are tested</p></li>
<li><p>MPI Fortran and C compilers: mpif90, mpicc</p></li>
<li><p>BLAS and LAPACK libraries: <a class="reference external" href="https://github.com/xianyi/OpenBLAS/">OpenBLAS</a> with gfortran and MKL with ifort</p></li>
<li><p>ARPACK library: <a class="reference external" href="https://github.com/opencollab/arpack-ng/">arpack-ng</a>  with mpi enabled</p></li>
<li><p>Only Python3 is supported</p></li>
<li><p>numpy, scipy, sympy, matplotlib, sphinx, numpydoc</p></li>
<li><p>mpi4py with same MPI compilers as building edrixs</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="install-and-use-edrixs-via-anaconda-only-linux-now">
<h2>Install and use edrixs via Anaconda (only Linux now)<a class="headerlink" href="#install-and-use-edrixs-via-anaconda-only-linux-now" title="Permalink to this headline">¶</a></h2>
<p>A conda package has been built for Linux systems. To use edrixs via Anaconda, you need first to install <a class="reference external" href="https://www.anaconda.com/distribution/">Anaconda</a> in your system.
Then, create and activate a conda env, for example, called <code class="docutils literal notranslate"><span class="pre">edrixs_env</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda create --name edrixs_env python=3.7
$ conda activate edrixs_env
</pre></div>
</div>
<p>Install edrixs by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda install -c lightsource2-tag edrixs
</pre></div>
</div>
<p>where, <a class="reference external" href="https://anaconda.org/lightsource2-tag/">lightsource2-tag</a> is an Anaconda package repository maintained by <a class="reference external" href="https://github.com/NSLS-II/lightsource2-recipes/">DAMA</a> at NSLS-II at  Brookhaven National Laboratory.</p>
</div>
<div class="section" id="build-from-source">
<h2>Build from source<a class="headerlink" href="#build-from-source" title="Permalink to this headline">¶</a></h2>
<p>We will show how to build edrixs from source on Ubuntu Linux 18.04 and macOS Mojave (OSX 10.14) as examples.
We will use gcc, gfortran, openmpi and OpenBLAS in these examples.
Building edrixs on other versions of Linux or OSX, or with Intel’s ifort+MKL will be similar.</p>
<div class="section" id="ubuntu-linux-18-04">
<h3>Ubuntu Linux 18.04<a class="headerlink" href="#ubuntu-linux-18-04" title="Permalink to this headline">¶</a></h3>
<p>Install compilers and tools:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sudo apt-get update
$ sudo apt-get install gcc libgcc-7-dev gfortran g++
$ sudo apt-get install git autoconf automake ssh wget
$ sudo apt-get install python3 libpython3-dev python3-pip
</pre></div>
</div>
<p>We will assume <code class="docutils literal notranslate"><span class="pre">python</span></code> pointing to <code class="docutils literal notranslate"><span class="pre">python3.7</span></code> and <code class="docutils literal notranslate"><span class="pre">pip</span></code> pointing to <code class="docutils literal notranslate"><span class="pre">pip3.7</span></code> from now on. If this is not the case, you can make links explicitly <a class="footnote-reference brackets" href="#id3" id="id1">1</a> <a class="footnote-reference brackets" href="#id4" id="id2">2</a>.
Check we are using the expected python and pip:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ which python
$ python --version
$ which pip
$ pip --version
</pre></div>
</div>
<p>Install python libraries:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sudo pip install numpy scipy sympy matplotlib
</pre></div>
</div>
<p>openmpi, OpenBLAS, ARPACK can be installed by <code class="docutils literal notranslate"><span class="pre">apt-get</span></code>, but their versions are old and may not work properly.
However, they can also be compiled from source easily. In the following, we will show both ways, but we always recommend to build newer ones from source.</p>
<p>openmpi can be installed by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sudo apt-get install openmpi-bin libopenmpi-dev
</pre></div>
</div>
<p>or from newer version of source, for example v3.1.4:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ wget https://download.open-mpi.org/release/open-mpi/v3.1/openmpi-3.1.4.tar.bz2
$ tar -xjf openmpi-3.1.4.tar.bz2
$ cd openmpi-3.1.4
$ ./configure CC=gcc CXX=g++ FC=gfortran
$ make
$ sudo make install
</pre></div>
</div>
<p>the compiling process will take a while.</p>
<p>OpenBLAS can be installed by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sudo apt-get install libopenblas-dev
</pre></div>
</div>
<p>or from a newer version of source:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ wget https://github.com/xianyi/OpenBLAS/archive/v0.3.6.tar.gz
$ tar -xzf v0.3.6.tar.gz
$ cd OpenBLAS-0.3.6
$ make CC=gcc FC=gfortran
$ sudo make PREFIX=/usr/local install
</pre></div>
</div>
<p>ARPACK can be installed by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sudo apt-get install libarpack2-dev libparpack2-dev
</pre></div>
</div>
<p>or from a newer version of source:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ wget https://github.com/opencollab/arpack-ng/archive/3.6.3.tar.gz
$ tar -xzf 3.6.3.tar.gz
$ cd arpack-ng-3.6.3
$ ./bootstrap
$ ./configure --enable-mpi --with-blas=&quot;-L/usr/local/lib/ -lopenblas&quot; FC=gfortran F77=gfortran MPIFC=mpif90 MPIF77=mpif90
$ make
$ sudo make install
</pre></div>
</div>
<p>mpi4py can be installed by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ export MPICC=/usr/local/bin/mpicc
$ sudo pip install --no-cache-dir mpi4py
</pre></div>
</div>
<p>or from source:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ wget https://github.com/mpi4py/mpi4py/archive/3.0.1.tar.gz
$ tar xzf 3.0.1.tar.gz
$ cd mpi4py-3.0.1
</pre></div>
</div>
<p>edit mpi.cfg to set MPI paths as following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">mpi</span><span class="p">]</span>
<span class="n">mpi_dir</span>              <span class="o">=</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span>
<span class="n">mpicc</span>                <span class="o">=</span> <span class="o">%</span><span class="p">(</span><span class="n">mpi_dir</span><span class="p">)</span><span class="n">s</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">mpicc</span>
<span class="n">mpicxx</span>               <span class="o">=</span> <span class="o">%</span><span class="p">(</span><span class="n">mpi_dir</span><span class="p">)</span><span class="n">s</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">mpicxx</span>
<span class="n">include_dirs</span>         <span class="o">=</span> <span class="o">%</span><span class="p">(</span><span class="n">mpi_dir</span><span class="p">)</span><span class="n">s</span><span class="o">/</span><span class="n">include</span>
<span class="n">libraries</span>            <span class="o">=</span> <span class="n">mpi</span>
<span class="n">library_dirs</span>         <span class="o">=</span> <span class="o">%</span><span class="p">(</span><span class="n">mpi_dir</span><span class="p">)</span><span class="n">s</span><span class="o">/</span><span class="n">lib</span>
<span class="n">runtime_library_dirs</span> <span class="o">=</span> <span class="o">%</span><span class="p">(</span><span class="n">mpi_dir</span><span class="p">)</span><span class="n">s</span><span class="o">/</span><span class="n">lib</span>
</pre></div>
</div>
<p>and comment all other contents. Then, build and install by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python setup.py build
$ sudo pip install .
</pre></div>
</div>
<p>Check whether the MPI paths are correct by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python
&gt;&gt;&gt; import mpi4py
&gt;&gt;&gt; mpi4py.get_config()
{&#39;mpicc&#39;: &#39;/usr/local/bin/mpicc&#39;,
 &#39;mpicxx&#39;: &#39;/usr/local/bin/mpicxx&#39;,
 &#39;include_dirs&#39;: &#39;/usr/local/include&#39;,
 &#39;libraries&#39;: &#39;mpi&#39;,
 &#39;library_dirs&#39;: &#39;/usr/local/lib&#39;,
 &#39;runtime_library_dirs&#39;: &#39;/usr/local/lib&#39;}
</pre></div>
</div>
<p>Now, we are ready to build edrixs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ git clone https://github.com/NSLS-II/edrixs.git
$ cd edrixs
$ make -C src F90=mpif90 LIBS=&quot;-L/usr/local/lib -lopenblas -lparpack -larpack&quot;
$ make -C src install
$ python setup.py config_fc --f77exec=mpif90 --f90exec=mpif90 build_ext --libraries=openblas,parpack,arpack --library-dirs=/usr/local/lib
$ sudo pip install .
</pre></div>
</div>
<p>You can add <code class="docutils literal notranslate"><span class="pre">edrixs/bin</span></code> to <code class="docutils literal notranslate"><span class="pre">PATH</span></code>. Start to play with edrixs by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python
&gt;&gt;&gt; import edrixs
&gt;&gt;&gt; edrixs.some_functions(...)
</pre></div>
</div>
<p>or go to <code class="docutils literal notranslate"><span class="pre">examples</span></code> directory to run some examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cd examples/more/ED/14orb
$ ./get_inputs.py
$ mpirun -np 2 ../../../../src/ed.x
$ mpirun -np 2 ./run_fedsolver.py
$ cd ../../RIXS/LaNiO3_thin
$ mpirun -np 2 ./run_rixs_fsolver.py
</pre></div>
</div>
<p>if no errors, the installation is successful.</p>
</div>
<div class="section" id="macos-mojave-osx-10-14">
<h3>macOS Mojave (OSX 10.14)<a class="headerlink" href="#macos-mojave-osx-10-14" title="Permalink to this headline">¶</a></h3>
<p>Install newest Xcode through App store.</p>
<div class="section" id="use-macports">
<h4>Use MacPorts<a class="headerlink" href="#use-macports" title="Permalink to this headline">¶</a></h4>
<p>Download and install <a class="reference external" href="https://www.macports.org/install.php/">MacPorts</a>.
Update MacPorts by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sudo port -v selfupdate
</pre></div>
</div>
<p>Install gcc8, arpack, openblas and openmpi:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sudo port -v install gcc8
$ sudo port select gcc mp-gcc8
$ sudo port -v install openmpi-default +gcc8
$ sudo port -v install openblas +gcc8
$ sudo port -v install arpack +openblas +openmpi
$ sudo port select --set mpi openmpi-mp-fortran
</pre></div>
</div>
<p>Install Python, pip, numpy, scipy, sympy, matplotlib:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sudo port -v install python37 py37-pip
$ sudo port -v install py37-numpy +gcc8 +openblas
$ sudo port -v install py37-scipy +gcc8 +openblas
$ sudo port -v install py37-sympy
$ sudo port -v install py37-matplotlib
</pre></div>
</div>
<p><strong>Notes:</strong></p>
<ul class="simple">
<li><p>DO NOT use pip to install numpy because it will use <code class="docutils literal notranslate"><span class="pre">clang</span></code> as default compiler, which has a strange bug when using <code class="docutils literal notranslate"><span class="pre">f2py</span></code> with <code class="docutils literal notranslate"><span class="pre">mpif90</span></code> compiler. If you cannot solve this issue by <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">port</span> <span class="pre">install</span> <span class="pre">py37-numpy</span> <span class="pre">+gcc8</span></code>, you can compile numpy from its source with <code class="docutils literal notranslate"><span class="pre">gcc</span></code> compiler. Always use gcc to compile numpy if you want to build it from source.</p></li>
<li><p>You can also try <code class="docutils literal notranslate"><span class="pre">gcc9</span></code> if it is already avaiable, but be sure to change all <code class="docutils literal notranslate"><span class="pre">gcc8</span></code> to <code class="docutils literal notranslate"><span class="pre">gcc9</span></code> in the above commands.</p></li>
</ul>
<p>We will assume <code class="docutils literal notranslate"><span class="pre">python</span></code> pointing to <code class="docutils literal notranslate"><span class="pre">python3.7</span></code> and <code class="docutils literal notranslate"><span class="pre">pip</span></code> pointing to <code class="docutils literal notranslate"><span class="pre">pip3.7</span></code> from now on. If this is not the case, you can make links explicitly.
Check we are using the expected python and pip:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ which python
$ python --version
$ which pip
$ pip --version
</pre></div>
</div>
<p>Add the following two lines into <code class="docutils literal notranslate"><span class="pre">~/.bash_profile</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>export PATH=&quot;/opt/local/bin:/opt/local/sbin:$PATH&quot;
export PATH=/opt/local/Library/Frameworks/Python.framework/Versions/3.7/bin:$PATH
</pre></div>
</div>
<p>Close current terminal and open a new one.</p>
<p>Install mpi4py:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ export MPICC=/opt/local/bin/mpicc
$ sudo pip install --no-cache-dir mpi4py
</pre></div>
</div>
<p>Please be sure to check whether the MPI paths of mpi4py are correct by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python
&gt;&gt;&gt; import mpi4py
&gt;&gt;&gt; mpi4py.get_config()
{&#39;mpicc&#39;: &#39;/opt/local/bin/mpicc&#39;}
</pre></div>
</div>
<p>Now, we are ready to build edrixs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ git clone https://github.com/NSLS-II/edrixs.git
$ cd edrixs
$ make -C src F90=mpif90 LIBS=&quot;-L/opt/local/lib -lopenblas -lparpack -larpack&quot;
$ make -C src install
$ python setup.py config_fc --f77exec=mpif90 --f90exec=mpif90 build_ext --libraries=openblas,parpack,arpack --library-dirs=/opt/local/lib
$ sudo pip install .
</pre></div>
</div>
<p>You can add <code class="docutils literal notranslate"><span class="pre">edrixs/bin</span></code> to the enviroment variable <code class="docutils literal notranslate"><span class="pre">PATH</span></code> in ~/.bash_profile.</p>
<p>Go to <code class="docutils literal notranslate"><span class="pre">examples</span></code> directory to run some examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cd examples/more/ED/14orb
$ ./get_inputs.py
$ mpirun -np 2 ../../../../src/ed.x
$ mpirun -np 2 ./run_fedsolver.py
$ cd ../../RIXS/LaNiO3_thin
$ mpirun -np 2 ./run_rixs_fsolver.py
</pre></div>
</div>
<p>if no errors, the installation is successful.</p>
<p>All done, enjoy!</p>
</div>
<div class="section" id="use-homebrew">
<h4>Use Homebrew<a class="headerlink" href="#use-homebrew" title="Permalink to this headline">¶</a></h4>
<p>Install Homebrew:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ /usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;
</pre></div>
</div>
<p>Add following line to <code class="docutils literal notranslate"><span class="pre">~/.bash_profile</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">PATH</span><span class="o">=</span><span class="s2">&quot;/usr/local/bin:$PATH&quot;</span>
</pre></div>
</div>
<p>Install gcc9:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ brew install gcc@9
</pre></div>
</div>
<p>Install openblas and arpack:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ brew install openblas
$ brew install arpack
</pre></div>
</div>
<p>openmpi has been automatically installed when installing arpack.</p>
<p>Install python3.7:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ brew install python
</pre></div>
</div>
<p>We will assume <code class="docutils literal notranslate"><span class="pre">python</span></code> pointing to <code class="docutils literal notranslate"><span class="pre">python3.7</span></code> and <code class="docutils literal notranslate"><span class="pre">pip</span></code> pointing to <code class="docutils literal notranslate"><span class="pre">pip3.7</span></code> from now on. If this is not the case, you can make link explicitly.
Check we are using the expected python and pip:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ which python
$ python --version
$ which pip
$ pip --version
</pre></div>
</div>
<p>Make links if gcc, g++ and gfortran are not pointing to gcc-9, g++-9, gfortran-9, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ln -s /usr/local/Cellar/gcc/9.1.0/bin/gcc-9 /usr/local/bin/gcc
$ ln -s /usr/local/Cellar/gcc/9.1.0/bin/g++-9 /usr/local/bin/g++
$ ln -s /usr/local/Cellar/gcc/9.1.0/bin/gfortran-9 /usr/local/bin/gfortran
</pre></div>
</div>
<p>DO NOT install numpy through <code class="docutils literal notranslate"><span class="pre">pip</span></code> because it uses <code class="docutils literal notranslate"><span class="pre">clang</span></code> as default compiler, which will cause problems.
We will build numpy from source with gcc:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ wget https://github.com/numpy/numpy/archive/v1.16.3.tar.gz
$ tar xzf v1.16.3.tar.gz
$ cd numpy-1.16.3
$ export CC=gcc CXX=g++
$ python setup.py build
$ pip install .
</pre></div>
</div>
<p>Install scipy, sympy, matplotlib:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pip install scipy, sympy, matplotlib
$ export MPICC=/usr/local/bin/mpicc
$ pip install --no-cache-dir mpi4py
</pre></div>
</div>
<p>Please be sure to check whether the MPI paths of mpi4py are correct by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python
&gt;&gt;&gt; import mpi4py
&gt;&gt;&gt; mpi4py.get_config()
{&#39;mpicc&#39;: &#39;/usr/local/bin/mpicc&#39;}
</pre></div>
</div>
<p>Now, we are ready to build edrixs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ git clone https://github.com/NSLS-II/edrixs.git
$ cd edrixs
$ make -C src F90=mpif90 LIBS=&quot;-L/usr/local/opt/openblas/lib -lopenblas -L/usr/local/lib -lparpack -larpack&quot;
$ make -C src install
$ python setup.py config_fc --f77exec=mpif90 --f90exec=mpif90 build_ext --libraries=openblas,parpack,arpack --library-dirs=/usr/local/lib:/usr/local/opt/openblas/lib
$ pip install .
</pre></div>
</div>
<p>You can add <code class="docutils literal notranslate"><span class="pre">edrixs/bin</span></code> to the enviroment variable <code class="docutils literal notranslate"><span class="pre">PATH</span></code> in <code class="docutils literal notranslate"><span class="pre">~/.bash_profile</span></code>.</p>
<p>Go to <code class="docutils literal notranslate"><span class="pre">examples</span></code> directory to run some examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cd examples/more/ED/14orb
$ ./get_inputs.py
$ mpirun -np 2 ../../../../src/ed.x
$ mpirun -np 2 ./run_fedsolver.py
$ cd ../../RIXS/LaNiO3_thin
$ mpirun -np 2 ./run_rixs_fsolver.py
</pre></div>
</div>
<p>if no errors, the installation is successful.</p>
<p>All done, enjoy!</p>
<dl class="footnote brackets">
<dt class="label" id="id3"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>To change your default python you need to add a line to your <code class="docutils literal notranslate"><span class="pre">~/.bashrc</span></code> on linux or to your <code class="docutils literal notranslate"><span class="pre">~/.bash_profile</span></code> on OSX. This should be <code class="docutils literal notranslate"><span class="pre">alias</span> <span class="pre">python='/usr/local/bin/python3'</span></code> where the path is determined by calling <code class="docutils literal notranslate"><span class="pre">which</span> <span class="pre">python3</span></code> from your terminal.</p>
</dd>
<dt class="label" id="id4"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>To change your default pip you need to add a line to your <code class="docutils literal notranslate"><span class="pre">~/.bashrc</span></code> on linux or to your <code class="docutils literal notranslate"><span class="pre">~/.bash_profile</span></code> on OSX. This should be <code class="docutils literal notranslate"><span class="pre">alias</span> <span class="pre">pip='/usr/bin/pip3'</span></code> where the path is determined by calling <code class="docutils literal notranslate"><span class="pre">which</span> <span class="pre">pip3</span></code> from your terminal.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="usedocker.html" class="btn btn-neutral float-right" title="edrixs and docker" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="whatisedrixs.html" class="btn btn-neutral float-left" title="What is edrixs?" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Brookhaven National Lab

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>